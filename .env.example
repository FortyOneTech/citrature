# ================================================================================
# Citrature Platform - Centralized Environment Configuration
# ================================================================================
# This file defines the complete configuration contract for the Citrature platform.
# All services (api, worker, frontend) consume these variables from a single source
# of truth, ensuring environmental consistency across the distributed system.
# ================================================================================

# --------------------------------
# API Configuration
# --------------------------------
# The public-facing URLs for the API and frontend services
API_ORIGIN=http://localhost:8000
WEB_ORIGIN=http://localhost:3000

# --------------------------------
# Database Configuration
# --------------------------------
# PostgreSQL connection string with pgvector support
POSTGRES_DSN=postgresql://citrature:password@db:5432/citrature

# The dimensionality of vectors stored in pgvector (must match embedding model)
PGVECTOR_DIMENSION=768

# --------------------------------
# Message Queue Configuration
# --------------------------------
# RabbitMQ connection URL for the message broker
RABBITMQ_URL=amqp://guest:guest@rabbitmq:5672/

# Redis connection URL for the result backend
REDIS_URL=redis://redis:6379/0

# --------------------------------
# External APIs - OpenRouter
# --------------------------------
# Base URL for the OpenRouter API
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# API key for authenticating with OpenRouter
OPENROUTER_API_KEY=sk-or-v1-xxxxxxxxxxxxxxxxxxxxxxxx

# --------------------------------
# External APIs - Crossref
# --------------------------------
# Base URL for the Crossref API
CROSSREF_BASE_URL=https://api.crossref.org

# Email address for the Crossref "polite" API pool
CROSSREF_MAILTO=hello@citrature.com

# --------------------------------
# Google OAuth Configuration
# --------------------------------
# Google OAuth 2.0 Client ID (obtained from Google Cloud Console)
GOOGLE_CLIENT_ID=xxxxxxxx.apps.googleusercontent.com

# Google OAuth 2.0 Client Secret (obtained from Google Cloud Console)
GOOGLE_CLIENT_SECRET=GOCSPX-xxxxxxxxxxxxxxxx

# The callback URI registered with Google for OAuth
GOOGLE_REDIRECT_URI=http://localhost:8000/auth/google/callback

# --------------------------------
# GROBID Service Configuration
# --------------------------------
# The URL for the self-hosted GROBID service
GROBID_BASE_URL=http://grobid:8070

# --------------------------------
# Google Cloud Storage Configuration
# --------------------------------
# The name of the Google Cloud Storage bucket for uploaded PDFs
GCS_BUCKET_NAME=citrature-uploads

# The Google Cloud project ID
GCS_PROJECT_ID=citrature-prod

# The JSON content of the GCS service account key (can be file path or JSON string)
GCS_CREDENTIALS_JSON={"type":"service_account",...}

# --------------------------------
# Usage Limits and Quotas
# --------------------------------
# Cap on the number of papers to fetch for a topic ingestion
MAX_TOPIC_PAPERS=30

# Cap on the traversal depth for citation graph building
MAX_GRAPH_DEPTH=3

# Cap on the number of collections a free-tier user can create
MAX_COLLECTIONS_PER_USER=1

# Cap on the number of chat messages per user per month
MONTHLY_CHAT_QUOTA=100

# Maximum upload size in megabytes
MAX_UPLOAD_SIZE_MB=50

# --------------------------------
# Security Configuration
# --------------------------------
# Secret key for JWT token signing and session management
SECRET_KEY=your_secret_key_here_min_32_characters_long

# JWT algorithm (default: HS256)
ALGORITHM=HS256

# JWT access token expiration time in minutes
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ================================================================================
# For local development with Docker Compose, copy this file to .env and update
# the values marked with placeholder text (xxxxxxxx).
# ================================================================================
